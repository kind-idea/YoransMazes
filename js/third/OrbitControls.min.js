THREE.OrbitControls=function(z,A){function B(b){if(!1!==a.enabled){b.preventDefault();var c=a.domElement===document?a.domElement.body:a.domElement;if(e===d.ROTATE){if(!0===a.noRotate)return;g.set(b.clientX,b.clientY);h.subVectors(g,k);a.rotateLeft(2*Math.PI*h.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*h.y/c.clientHeight*a.rotateSpeed);k.copy(g)}else if(e===d.DOLLY){if(!0===a.noZoom)return;l.set(b.clientX,b.clientY);t.subVectors(l,m);0<t.y?a.dollyIn():a.dollyOut();m.copy(l)}else if(e===d.PAN){if(!0===
a.noPan)return;n.set(b.clientX,b.clientY);p.subVectors(n,q);a.pan(p.x,p.y);q.copy(n)}a.update()}}function C(){!1!==a.enabled&&(a.domElement.removeEventListener("mousemove",B,!1),a.domElement.removeEventListener("mouseup",C,!1),a.dispatchEvent(x),e=d.NONE)}function D(b){if(!1!==a.enabled&&!0!==a.noZoom){b.preventDefault();b.stopPropagation();var c=0;void 0!==b.wheelDelta?c=b.wheelDelta:void 0!==b.detail&&(c=-b.detail);0<c?a.dollyOut():a.dollyIn();a.update();a.dispatchEvent(y);a.dispatchEvent(x)}}this.object=
z;this.domElement=void 0!==A?A:document;this.enabled=!0;this.center=this.target=new THREE.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=!1;this.rotateSpeed=1;this.noPan=!1;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var a=this,k=new THREE.Vector2,g=new THREE.Vector2,h=new THREE.Vector2,q=new THREE.Vector2,n=new THREE.Vector2,
p=new THREE.Vector2,r=new THREE.Vector3,f=new THREE.Vector3,m=new THREE.Vector2,l=new THREE.Vector2,t=new THREE.Vector2,u=0,v=0,s=1,w=new THREE.Vector3,E=new THREE.Vector3,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},e=d.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();var F=(new THREE.Quaternion).setFromUnitVectors(z.up,new THREE.Vector3(0,1,0)),G=F.clone().inverse(),H={type:"change"},y={type:"start"},x={type:"end"};this.rotateLeft=
function(b){void 0===b&&(b=2*Math.PI/60/60*a.autoRotateSpeed);v-=b};this.rotateUp=function(b){void 0===b&&(b=2*Math.PI/60/60*a.autoRotateSpeed);u-=b};this.panLeft=function(a){var c=this.object.matrix.elements;r.set(c[0],c[1],c[2]);r.multiplyScalar(-a);w.add(r)};this.panUp=function(a){var c=this.object.matrix.elements;r.set(c[4],c[5],c[6]);r.multiplyScalar(a);w.add(r)};this.pan=function(b,c){var d=a.domElement===document?a.domElement.body:a.domElement;if(void 0!==a.object.fov){var e=a.object.position.clone().sub(a.target).length(),
e=e*Math.tan(a.object.fov/2*Math.PI/180);a.panLeft(2*b*e/d.clientHeight);a.panUp(2*c*e/d.clientHeight)}else void 0!==a.object.top?(a.panLeft(b*(a.object.right-a.object.left)/d.clientWidth),a.panUp(c*(a.object.top-a.object.bottom)/d.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};this.dollyIn=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));s/=b};this.dollyOut=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));s*=b};this.update=function(){var b=
this.object.position;f.copy(b).sub(this.target);f.applyQuaternion(F);var c=Math.atan2(f.x,f.z),d=Math.atan2(Math.sqrt(f.x*f.x+f.z*f.z),f.y);this.autoRotate&&this.rotateLeft(2*Math.PI/60/60*a.autoRotateSpeed);var c=c+v,d=d+u,d=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,d)),d=Math.max(1E-6,Math.min(Math.PI-1E-6,d)),e=f.length()*s,e=Math.max(this.minDistance,Math.min(this.maxDistance,e));this.target.add(w);f.x=e*Math.sin(d)*Math.sin(c);f.y=e*Math.cos(d);f.z=e*Math.sin(d)*Math.cos(c);f.applyQuaternion(G);
b.copy(this.target).add(f);this.object.lookAt(this.target);u=v=0;s=1;w.set(0,0,0);1E-6<E.distanceToSquared(this.object.position)&&(this.dispatchEvent(H),E.copy(this.object.position))};this.reset=function(){e=d.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.update()};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousedown",function(b){if(!1!==a.enabled){b.preventDefault();if(0===b.button){if(!0===
a.noRotate)return;e=d.ROTATE;k.set(b.clientX,b.clientY)}else if(1===b.button){if(!0===a.noZoom)return;e=d.DOLLY;m.set(b.clientX,b.clientY)}else if(2===b.button){if(!0===a.noPan)return;e=d.PAN;q.set(b.clientX,b.clientY)}a.domElement.addEventListener("mousemove",B,!1);a.domElement.addEventListener("mouseup",C,!1);a.dispatchEvent(y)}},!1);this.domElement.addEventListener("mousewheel",D,!1);this.domElement.addEventListener("DOMMouseScroll",D,!1);this.domElement.addEventListener("touchstart",function(b){if(!1!==
a.enabled){switch(b.touches.length){case 1:if(!0===a.noRotate)return;e=d.TOUCH_ROTATE;k.set(b.touches[0].pageX,b.touches[0].pageY);break;case 2:if(!0===a.noZoom)return;e=d.TOUCH_DOLLY;var c=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;c=Math.sqrt(c*c+b*b);m.set(0,c);break;case 3:if(!0===a.noPan)return;e=d.TOUCH_PAN;q.set(b.touches[0].pageX,b.touches[0].pageY);break;default:e=d.NONE}a.dispatchEvent(y)}},!1);this.domElement.addEventListener("touchend",function(){!1!==
a.enabled&&(a.dispatchEvent(x),e=d.NONE)},!1);this.domElement.addEventListener("touchmove",function(b){if(!1!==a.enabled){b.preventDefault();b.stopPropagation();var c=a.domElement===document?a.domElement.body:a.domElement;switch(b.touches.length){case 1:if(!0===a.noRotate)break;if(e!==d.TOUCH_ROTATE)break;g.set(b.touches[0].pageX,b.touches[0].pageY);h.subVectors(g,k);a.rotateLeft(2*Math.PI*h.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*h.y/c.clientHeight*a.rotateSpeed);k.copy(g);a.update();
break;case 2:if(!0===a.noZoom)break;if(e!==d.TOUCH_DOLLY)break;c=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;b=Math.sqrt(c*c+b*b);l.set(0,b);t.subVectors(l,m);0<t.y?a.dollyOut():a.dollyIn();m.copy(l);a.update();break;case 3:if(!0===a.noPan)break;if(e!==d.TOUCH_PAN)break;n.set(b.touches[0].pageX,b.touches[0].pageY);p.subVectors(n,q);a.pan(p.x,p.y);q.copy(n);a.update();break;default:e=d.NONE}}},!1);window.addEventListener("keydown",function(b){if(!1!==a.enabled&&!0!==
a.noKeys&&!0!==a.noPan)switch(b.keyCode){case a.keys.UP:a.pan(0,a.keyPanSpeed);a.update();break;case a.keys.BOTTOM:a.pan(0,-a.keyPanSpeed);a.update();break;case a.keys.LEFT:a.pan(a.keyPanSpeed,0);a.update();break;case a.keys.RIGHT:a.pan(-a.keyPanSpeed,0),a.update()}},!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);